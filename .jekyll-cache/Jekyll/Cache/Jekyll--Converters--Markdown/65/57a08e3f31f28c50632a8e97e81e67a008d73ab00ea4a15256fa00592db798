I"¼<p>åœ¨ç»™Alamofireç”¨protocolå°è£…ä¸€å±‚ä¸šåŠ¡çš„æ—¶å€™ï¼Œå®šä¹‰äº†ä»¥ä¸‹çš„åè®®å’Œæ–¹æ³•</p>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">protocol</span> <span class="kt">BaseRequest</span> <span class="p">{</span>
<span class="p">}</span>
<span class="kd">extension</span> <span class="kt">FIDRequest</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">complete</span><span class="p">(</span><span class="n">_</span> <span class="nv">completionHandler</span><span class="p">:</span> <span class="kd">@escaping</span> <span class="p">((</span><span class="kt">DataResponse</span><span class="o">&lt;</span><span class="kt">Any</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">()))</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">url</span> <span class="o">=</span> <span class="nf">baseURL</span><span class="p">()</span><span class="o">+</span><span class="nf">requestURI</span><span class="p">()</span>
            <span class="kt">Alamofire</span><span class="o">.</span><span class="nf">request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="nv">method</span><span class="p">:</span> <span class="nf">method</span><span class="p">(),</span> <span class="nv">parameters</span><span class="p">:</span> <span class="nf">parameters</span><span class="p">(),</span> <span class="nv">encoding</span><span class="p">:</span> <span class="nf">encoding</span><span class="p">(),</span> <span class="nv">headers</span><span class="p">:</span> <span class="nf">headers</span><span class="p">())</span><span class="o">.</span><span class="nf">responseJSON</span><span class="p">(</span><span class="nv">completionHandler</span><span class="p">:</span> <span class="n">completionHandler</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">protocol</span> <span class="kt">Request</span> <span class="p">{</span>

<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">Request</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">request</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">WBBaseRequest</span> <span class="p">{</span>
            <span class="n">complete</span> <span class="p">{</span>  <span class="p">(</span><span class="n">response</span><span class="p">)</span>  <span class="k">in</span>
<span class="c1">//è¿™é‡Œè¿˜æœ‰æ®µä»£ç é€ æˆå¾ªç¯å¼•ç”¨</span>
            <span class="p">}</span>
       <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p>è¿™æ—¶å€™é—®é¢˜å°±æ¥äº†ï¼Œæ­£å¸¸æƒ…å†µä¸‹ï¼Œåº”è¯¥ä½¿ç”¨<code class="language-plaintext highlighter-rouge">[weak self]</code>å°±å¯ä»¥è§£å†³äº†ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨<code class="language-plaintext highlighter-rouge">protocol</code>çš„æ—¶å€™ï¼Œæ˜¯æ— æ³•ä½¿ç”¨<code class="language-plaintext highlighter-rouge">[weak self]</code>çš„ï¼Œç„¶åå°±ä¼šæœ‰ä»¥ä¸‹çš„æŠ¥é”™
<code class="language-plaintext highlighter-rouge">'weak' may only be applied to class and class-bound protocol types, not 'Self'</code></p>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="kd">func</span> <span class="nf">request</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">WBBaseRequest</span> <span class="p">{</span>
            <span class="n">complete</span> <span class="p">{</span>  <span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="p">[</span><span class="k">weak</span> <span class="k">self</span><span class="p">]</span>  <span class="k">in</span> <span class="c1">//è¿™ä¸ªåœ°æ–¹ä¼šæŠ¥é”™ 'weak' may only be applied to class and class-bound protocol types, not 'Self'</span>
<span class="c1">//è¿™é‡Œè¿˜æœ‰æ®µä»£ç é€ æˆå¾ªç¯å¼•ç”¨</span>
            <span class="p">}</span>
       <span class="p">}</span>
</code></pre></div></div>

<p>ç›´æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹å¼æ˜¯ï¼Œå°† <code class="language-plaintext highlighter-rouge">BaseRequest</code>å£°æ˜ä¸ºåªæœ‰ç±»æ‰å¯ä»¥ä½¿ç”¨</p>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">protocol</span> <span class="kt">BaseRequest</span> <span class="p">:</span> <span class="kd">class</span> <span class="p">{</span>
<span class="p">}</span>
</code></pre></div></div>
<p>ç„¶åå°±å¯ä»¥æ„‰å¿«çš„ä½¿ç”¨<code class="language-plaintext highlighter-rouge">[weak self]</code></p>

<p>æ€»ç»“ï¼š
<code class="language-plaintext highlighter-rouge">weak</code>åªèƒ½ç”¨åœ¨ç±»æˆ–è€…ç±»çš„åè®®ä¸­ï¼Œå¦‚æœåœ¨åè®®æ‰©å±•ä¸­ä½¿ç”¨äº†ç±»è€Œé€ æˆäº†å¾ªç¯å¼•ç”¨ï¼Œåè®®å°±éœ€è¦æŒ‡å®šå¿…é¡»æ˜¯<code class="language-plaintext highlighter-rouge">class</code>æ‰å¯ä»¥ä½¿ç”¨ï¼Œ<code class="language-plaintext highlighter-rouge">struct</code>å’Œ<code class="language-plaintext highlighter-rouge">enum</code>æ˜¯ä¸ä¼šé€ æˆå¾ªç¯å¼•ç”¨çš„
å‚è€ƒé“¾æ¥ï¼š 
<a href="https://stackoverflow.com/questions/38841127/why-can-the-keyword-weak-only-be-applied-to-class-and-class-bound-protocol-typ">Why can the keyword â€œweakâ€ only be applied to class and class-bound protocol types</a>
 <a href="https://stackoverflow.com/questions/24066304/how-can-i-make-a-weak-protocol-reference-in-pure-swift-w-o-objc">How can I make a weak protocol reference in â€˜pureâ€™ Swift (w/o @objc)</a></p>

:ET